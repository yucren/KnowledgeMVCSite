@using KnowledgeMVCSite.Models
@model List<Knowledge>
@{
    ViewBag.Title = "Index";
}

<div id="app">
    <div class="row" style="margin-left:0;margin-right:0;margin-bottom:5px; padding: 10px 0; background-color:white">
        <div class="col-md-12">
            <a href='@Url.Action("Create","Knowledge")' class="btn btn-primary">
                <span class="glyphicon">
                    <img src="~/Content/img/Create.png" />
                </span> 创建知识
            </a>

        </div>

    </div>
</div>
    

    <div id="contentBody">
        @foreach (Knowledge item in Model)
        {
            <div style="padding:10px 10px 20px 10px;margin-top:30px;background-color:white">
                <div style="padding-bottom:10px">
                    <p style="display:block;font-size:20px">@item.User.UserName <span style="color:blue;font-size:25px;" class="glyphicon glyphicon-chevron-right"></span>@item.Category.Name</p>
                    <strong style="font-size:18px">@item.Title </strong>
                </div>

                <div class="panel-body-noborder">
                    @Html.Raw(@HttpUtility.UrlDecode(@item.Context))
                </div>
                <div style="margin-top:40px">
                    <p><span style="color:darkgray" class="glyphicon glyphicon-thumbs-up"></span></p>
                    <button class="btn btn-primary pull-right" style="margin-top:-20px;margin-right:40%" onclick="discuss(event,@item.Id)">
                        <span class="glyphicon glyphicon-comment" >
                            </span>评论
                    </button>
                    <button class="btn btn-primary pull-right" style="margin-top:-20px;margin-right:-40%">
                        <span class="glyphicon glyphicon-share-alt"></span>分享
                    </button>
                </div>
                <div class="discuss" style="margin-top:40px"></div>

            </div>
       
     
    
    }
        </div>




<style>
   
</style>


    @section Scripts
{      
        <script>
            new Vue({
                el: '#app',
                data: {
                    message: '<h1>菜鸟教程</h1>'
                }
            });

            var discussDIV = null;
            var dicusseId = 0;
            var button = null;
            function discuss(event, id) {
                if (discussDIV == null) {
                    discussDIV = $($(event.target).parents("div").get(0)).next(".discuss");
                    button = event.target;
                    dicusseId = id;
                    discussDIV.load('@Url.Action("DiscsussPartial", "Knowledge")', { knowledgeId: id });

                }

                else if (button === event.target) {
                    discussDIV.toggle()
                         discussDIV = $($(event.target).parents("div").get(0)).next(".discuss");
                        button = event.target;
                        dicusseId = id;
                        discussDIV.load('@Url.Action("DiscsussPartial", "Knowledge")', { knowledgeId: id });

                }
                else   {
                        discussDIV.hide();
                        discussDIV = $($(event.target).parents("div").get(0)).next(".discuss");
                        button = event.target;
                        dicusseId = id;
                        discussDIV.load('@Url.Action("DiscsussPartial", "Knowledge")', { knowledgeId: id });
                        discussDIV.show();


                    
                }

                
                

       
               






            }
            function disucssSuccess() {
                console.log(dicusseId);
                discussDIV.load("Knowledge/DiscsussPartial", { knowledgeId: dicusseId });

            }

        </script>

    }


